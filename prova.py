import pandas as pd

xls = pd.ExcelFile("DB morpheus UniPV.xlsx", engine='openpyxl')

df = pd.read_excel("DB morpheus UniPV.xlsx")

sheet = pd.read_excel(xls, sheet_name="lista")

different_zygote = sheet.value_counts("PN")

print(different_zygote)



'''
Now, i'd like to merge some informations and evaluate my pre-trained models (ROCKET, LSTMFCN, ConvTran) on a stratified test.
Practically, the reference xlxs is made like this:
"slide	well	slide_well	maternal age	sperm quality	mezzo di coltura	PN	blasto ny	eup_aneup	LB	video_start	tPNa	tPNf	t2	t3	t4	t5	t6	t7	t8	t9+	tM	tSB	tB	tEB	t-biopsy	PN1a	PN2a	PN3a	altri Pna	PN1f	PN2f	PN3f	altri PNf	CP
D2013.02.19_S0675_I141	1	D2013.02.19_S0675_I141_1	37	OAT	quinns	2PN	1	euploide	non trasferito	0.2	11.9	22.9	26.2	36.9	38.4	50.6	51.8	52.8	55.3	71.1	96.4	103.6	111.9	114.5	138.4	12.2	12.2	-	-	22.7	22.7	-	-	2
D2013.02.19_S0675_I141	2	D2013.02.19_S0675_I141_2	37	OAT	quinns	2PN	1	euploide	non trasferito	0.2	7.7	24.2	27.2	37.7	39.9	51.1	53.6	68.3	83.4	83.7	95.9	102.9	108.1	113.7	138.4	7.7	8.7	-	-	24.2	23.9	-	-	2
"

Then, i have my test csv, which are "Normalized_sum_mean_mag_1Days_test.csv", "Normalized_sum_mean_mag_3Days_test.csv", "Normalized_sum_mean_mag_5Days_test.csv"

They are made like this:
"patient_id,dish_well,BLASTO NY,value_1,value_2,value_3,value_4,value_5,value_6,value_7,value_8,value_9,value_10,value_11,value_12,value_13,value_14,value_15,value_16,value_17,value_18,value_19,value_20,value_21,value_22,value_23,value_24,value_25,value_26,value_27,value_28,value_29,value_30,value_31,value_32,value_33,value_34,value_35,value_36,value_37,value_38,value_39,value_40,value_41,value_42,value_43,value_44,value_45,value_46,value_47,value_48,value_49,value_50,value_51,value_52,value_53,value_54,value_55,value_56,value_57,value_58,value_59,value_60,value_61,value_62,value_63,value_64,value_65,value_66,value_67,value_68,value_69,value_70,value_71,value_72,value_73,value_74,value_75,value_76,value_77,value_78,value_79,value_80,value_81,value_82,value_83,value_84,value_85,value_86,value_87,value_88,value_89,value_90,value_91,value_92,value_93
63,D2013.07.16_S0812_I141_1,0,0.15751797895343392,0.13932416814624274,0.12568394182686551,0.12994295875178513,0.13002521960655952,0.12443839492656711,0.13212294754256357,0.12357975728174929,0.11425239357083147,0.10668445584299902,0.09980901989815764,0.09126811381509535,0.09894675802464004,0.1038932515414964,0.10660390050761276,0.10679744650246316,0.10424781684000906,0.09045126139528688,0.09529557602737171,0.09385572173963885,0.09417130373785126,0.09639895570438745,0.08549508296476221,0.08014036120007344,0.07472637263664694,0.06984541979342049,0.06961480920758137,0.07361205936212509,0.07325323026514197,0.12061608233212107,0.19483008344329747,0.24175891128169857,0.25028845738740774,0.2030390832711466,0.1322945958866984,0.09100537246221184,0.07768508330662749,0.08647405109355391,0.08191930928901237,0.072574372637256,0.07396229995076074,0.06665585489197394,0.061617232872454734,0.05964239369950682,0.05872981900403911,0.0679275023300516,0.07309763207667766,0.06479799607563029,0.06375689831198497,0.04833327737097841,0.04617896273813219,0.05033269429653759,0.05205216239681513,0.05743956313120873,0.049986291126525195,0.051191880144015885,0.05211353063908476,0.044568586967288826,0.04771091507282448,0.04742977847511181,0.03991361544299077,0.0665005612605433,0.08089666768160299,0.10186965278746968,0.10321028239365682,0.07551575401202493,0.06246000309582219,0.036247053315525884,0.0355915856678201,0.03176327329981227,0.024712229769399255,0.04013186101326576,0.044810405251964225,0.050094012949308174,0.05746992746745827,0.04580807318261866,0.04208541164956535,0.04152332118836017,0.03805252832209099,0.03748285439074926,0.04612140145878245,0.053273862481383,0.05412607397279194,0.05779973227913962,0.0447736147623058,0.0404434228586347,0.04665008201340213,0.04429110505397931,0.04728794626456605,0.046714800383041384,0.03850324227610998,0.03674908512970584,0.035204615500932686
63,D2013.07.16_S0812_I141_2,1,0.1667515695537074,0.15356954929137567,0.14727883239533573,0.18386432471444536,0.20651892148131365,0.3376941941302875,0.3794606584264193,0.35224958387991806,0.320388471633063,0.200582739428083,0.1654973427779515,0.16461272641816793,0.1772270219141729,0.21126867115446685,0.29642494964720495,0.37790108276877976,0.41981440446651164,0.40040236552493563,0.31190113713221024,0.2275741674419546,0.16180787796156018,0.14890413146082526,0.1423857277264688,0.13773023845521362,0.14349580765822367,0.13599158326181954,0.14703625271807635,0.13912303868125586,0.12083149552198368,0.10441434862597952,0.08806341242907914,0.07153826960896166,0.06987441362301884,0.06176555214781615,0.06356947391350991,0.07306891234840954,0.07678383813280949,0.08099921203481478,0.07037943009612804,0.05891294914834052,0.053410547678060985,0.05566430018237631,0.05373727646370301,0.053972455405046006,0.052248297126451036,0.04775486265277247,0.052610263160880195,0.05446437592571062,0.053025465764781926,0.04720681227081607,0.03759688054412769,0.03438316426991702,0.026175504493015707,0.027439751195176974,0.03527362812474559,0.03558448948893725,0.04616510539310356,0.04792906927598951,0.04621840287398284,0.04913142998892397,0.04526982953714412,0.07202632225529959,0.08226358055978954,0.08420708081398044,0.08876130487156488,0.0742473653342068,0.07057903677594705,0.06599816397792291,0.06251838667916258,0.05612293261926886,0.05756147731175724,0.0651901741677922,0.08005685166146141,0.0796503898444239,0.09674846535614247,0.12729620585131723,0.14141894187902096,0.1595346338070946,0.17745504376522636,0.18992848163319312,0.2079107471248483,0.26355021068113493,0.2468050558599476,0.23185325467538825,0.20183154508864087,0.14057315654102084,0.11817359583408615,0.09983052162472948,0.10294802833202717,0.10063686682687883,0.11371841372382717,0.1188696000229636,0.12420483013750211
"

The only difference between these files is the number of columns (in the "config" i have a class "class utils:
    # Dim
    img_size                    = 500
    framePerDay                 = 96

    def num_frames_by_days(num_days):
        tot_frames = utils.framePerDay*num_days
        return tot_frames

    num_classes                 = 2
    project_name                = "BlastoClass_7days_672frames_optflow_LK"

    # Seed everything
    seed = 2024")


Ok, now please create a script that is able to match the "slide_well" of the xlxs "DB morpheus UniPV.xlxs" with the "dish_well" of the "normalized_..._test.csv" and the stratification to test the models has to be done according to the column "PN" in "DB morpheus UniPV.xlxs". 
"PN" is a categorical variable, and their values are the different types of zygote, summurized:
"2PN      4517
0PN       753
deg       249
1PN       203
3PN       174
>3PN       73
2.1PN      58
1.1PN      25"

For the stratification, you can merge 2.1 and 1.1




'''